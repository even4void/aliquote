<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Haskell and Vim</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Haskell and Vim</h1>
<p class="date">2022-09-11T11:21:42+02:00</p>
</header>
<p>Between two procrastination sessions on my couch due to my recent unexplained health problems that force me to stay on bed rest most of the time, I spent a few hours (uh, over several days and in several times because of the general lack of energy) cleaning up the files that were lying around on my computer, writing some maintenance scripts, devising cleaner dark and light colorscheme for my terminal and Neovim, and reviewing my Neovim configuration. It now starts like a breeze, as you can see by yourself:</p>
<pre class="shell"><code>~ » hyperfine &quot;nvim --headless +qa&quot; --warmup 5
Benchmark 1: nvim --headless +qa
  Time (mean ± σ):      36.1 ms ±   0.3 ms    [User: 29.1 ms, System: 7.4 ms]
  Range (min … max):    35.5 ms …  37.0 ms    78 runs


~ » hyperfine &quot;nvim --headless +qa&quot; --warmup 5
Benchmark 1: nvim --headless +qa
  Time (mean ± σ):      28.1 ms ±   0.6 ms    [User: 22.6 ms, System: 5.6 ms]
  Range (min … max):    27.0 ms …  29.7 ms    103 runs</code></pre>
<p>The above benchmarks were run with default (700-2,300 MHz) and high (up to 4,900 MHz) performance settings on my laptop. Most of the optimizations were done at the level of package management: I removed a bunch of unused stuff – the list of plugins I used went down from 15 to 10 plugins in the last two months, and moved most of the plugins to the <code>opt</code> directory. Lazy loading almost halved the above startup time indeed. I even wrote a little doc file for my custom commands.</p>
<p>Other than that, I spent a little time working on a general helper Bash script for the <code>keywordprg</code> utility, in order to get some help whether I’m not using a Language server or not. As an example I have this little script that can be used from the command line or as a <code>K</code> handler in (Neo)vim:</p>
<pre class="shell"><code>#!/usr/bin/env bash

BROWSER=elinks

case &quot;$1&quot; in
stata)
    &quot;$BROWSER&quot; https://www.stata.com/help.cgi\?&quot;${2}&quot;
    ;;
python)
    pydoc3 &quot;${2}&quot;
    ;;
r)
    Rscript -e &#39;args &lt;- commandArgs(TRUE); help(args[2], package=c(&quot;base&quot;, &quot;stats&quot;), help_type=&quot;text&quot;)&#39; --args &quot;${2}&quot;
    ;;
lisp)
    rc=$(hyperspec_lookup.ros &quot;$2&quot;)
    &quot;$BROWSER&quot; &quot;$rc&quot;
    ;;
help)
    echo &quot;Usage: $0 {stata|python|r|lisp|help}&quot;
    ;;
*)
    echo &quot;Usage: $0 {stata|python|r|lisp|help}&quot;
    ;;
esac

exit 0</code></pre>
<p>Not very polished, but it works as intended. The Lisp case was discussed in a <a href="/post/vim-and-lisp/">previous post</a>.</p>
<p>Back to the matter of this post. I originally intended to write about (Neo)vim and Haskell. After some reviews, I found that most of what I expected to say is already available online. I’m a hobbyist programmer, and I don’t spend a lot of time with Haskell or Clojure. When I did play with those languages some years ago this was always with Emacs, and I got Intero and Cider to assist me. For Clojure there seems to something like <a href="https://github.com/Olical/conjure">Conjure</a>, but I usually rely on Clojure LSP myself. Regarding Haskell, there’s some <a href="https://github.com/parsonsmatt/intero-neovim">Intero</a> for Vim too. Starter kits relying on <a href="https://github.com/begriffs/haskell-vim-now">ghcide, hlint, hoogle</a> are also available, but I don’t like starter kit anymore.</p>
<p>Without further ado, here are some retrospective posts on the state of Haskell and Vim in recent years:</p>
<ul>
<li><a href="https://www.stephendiehl.com/posts/vim_2016.html">vim and haskell in 2016</a>: Stephen Diehl has a long history with Haskell, even if it is mostly outdated material now that Haskell LSP is a thing, you may want to take a look at this post and other related posts on his site.</li>
<li><a href="https://blog.jez.io/haskell-development-with-neovim/">Haskell Development with Neovim</a>: This is mostly the old-fashioned way (several tools tied together with the help of Vim plugins).</li>
<li><a href="http://marco-lopes.com/articles/Vim-and-Haskell-in-2019/">Vim and Haskell in 2019</a>: This is a more modern take on Haskell+Neovim, with the old way of installing HIE and its wrapper.</li>
<li><a href="https://0xd34df00d.me/posts/2021/10/vim-and-haskell-in-2021.html">(neo)vim and Haskell, 2021 edition</a>: I ended up in the same position, using the now consolidated Haskell LSP and Neovim builtin stuff (instead of Coc, as the author does). In my view, Neovim builtins for LSPs are still inferior to Coc, but I came to like the defaults: less friction, more people behind them, and it’s always evolving, mostly for the better.</li>
</ul>
<p>{{% music %}}Galaxie 500 • <em>Today</em>{{% /music %}}</p>
</body>
</html>
